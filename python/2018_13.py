from aocd import get_data

inp = get_data(day=13, year=2018)

inp = r'''                                             /---------------------------------------------------------------------------------------------\          
 /----------------------<--------------------+----------------------------\                                                                |          
 |                                           |                            |                                                                |          
 |  /------------------\                     |                            |                              /--------------\                  |          
 |  |                  |                     |                            |                              |              |                  |          
 |  |                  |                     |       /--------------------+------------------------------+--------------+-------\          |          
 |  |                  |                     |       |      /-------------+------------------------------+--------------+-------+----------+-----\    
 |  |                  |                     |       |     /+-------------+-----------------\            | /------------+-------+--------\ |     |    
 |  |                  |                     |       |     ||             |                 |            | |            |       |        | |     |    
 |  |         /--------+---------------------+-------+-----++-------------+-------<---------+------------+-+--------\   |       |        | |     |    
 |  |         |   /----+---------------------+-------+-----++-------------+-----------------+------------+-+-----\  |   |       |        | |     |    
 |  |         |   |    |            /--------+-------+-----++-------------+------------\    |     /------+-+-\   |  |   |       |        | |     |    
 |  |         | /-+----+------------+--------+-------+-----++-------------+------------+----+-----+-\    | | |   |  |   |       |     /--+-+-----+---\
 |  |    /----+-+-+----+------------+--------+-------+-----++---\         |            |    | /---+-+----+-+-+---+--+---+-------+-----+--+\|     |   |
 |  |    |    | |/+----+------------+--------+-------+-----++---+---------+------------+----+-+---+\|    | | |   |  |   |       |  /--+--+++--\  |   |
 |  |   /+----+-+++----+------------+--------+-------+-----++---+---\     |            |    | |   |||    | | |   |  |   |       |  |  |  |||  |  |   |
 |  |   ||    | |||    |         /--+--------+\      |     ||   |  /+-----+------------+---\| |   |||    | | |   |  |   |       |  |  |  |||  |  |   |
 |  |   ||    | |||    |         |  |        ||   /--+-----++---+--++-----+------------+---++-+---+++----+-+-+---+--+---+-------+--+--+--+++--+--+\  |
 |  |   ||    | ||| /--+---------+--+-\/-----++-\ | /+-----++---+\ ||     |            |   || |   |||    | | |   |  |   | /-----+--+--+--+++\ |  ||  |
 |  |   ||    | ||| |  |         |  | ||     || | | ||     ||   || ||     |            |   || |   |||    | | |   |  |   | ^     |  |  |  |||| |  ||  |
 |  |   ||    | ||| |  |    /----+--+-++-----++-+-+-++-----++---++-++-\   |            |   || |   |||    | | |   |  |   | |     |  |  |  |||| |  ||  |
 |  |   ||    | ||\-+--+----+----+--+-++-----++-+-+-++-----++---++-++-+---+------------+---++-+---+++----+-+-+---/  |   | |     |  |  |  |||| |  ||  |
 |  | /-++----+-++--+--+----+-->-+--+-++-----++-+-+-++-----++>--++-++-+---+------------+---++\|   |||    | | |      |   | |     |  |  |  |||| |  ||  |
 |  | | ||    | ||  |  |    |    |  | ||     || | | ||     ||   || || |   |            |   ||||   |||    | | |      |   | |     |  |  |  |||| |  ||  |
 |  | | ||    | ||  |  |    |    |  \-++-----++-+-+-++-----++---++-++-+---+------------/   ||||   |||   /+-+-+------+---+-+-----+-\|  |  |||| |  ||  |
/+--+-+-++----+-++--+--+----+----+----++-----++\| | ||     ||   || || |   |                ||||   |||/--++-+-+--\   |   | |     | ||  |  |||| |  ||  |
||  | | ||    | ||  |  |    | /--+----++-----++++-+-++-----++---++-++-+---+----------------++++\  ||||  || | |  |   |   | |     | ||  |  |||| |  ||  |
||  | | \+----+-++--+--+----+-+--+----++-----++++-+-++-----++---++-+/ |   |                |||\+--++++--++-+-+--+---+---+-+-----+-++--+--+/|| |  ||  |
||  | |  \----+-++--+--+----+-+--+----++-----++++-+-++-----++---/| |  |   |                ||| |  ||||  || | |  |   |  /+-+-----+-++--+--+-++-+-\||  |
||  | |       | ||  |  |   /+-+--+---\||     |||| \-++-----++----+-+--+---+----------------+++-+--++++--++-+-+--+---+--++-+-----+-++--+--+-++-+-++/  |
||  | |       | ||  |  |   || |  |   |||     ||||   ||    /++----+-+\ |   |                ||| |  ||||  || | |  |   |  || |     | ||  |  | || | ||   |
||  | |       | ||  |  |/--++-+--+---+++-----++++---++----+++----+-++-+---+-------\        ||| |  ||||  || | |  |   |  || \-----+-++--+--+-+/ | ||   |
||  | |       | ||  |  ||  || |  |   |||     ||||   ||  /-+++----+-++-+---+-------+--------+++\|  ||||  || | |  |   |  ||       | ||  |  | |  | ||   |
||  | |       | ||  |  ||  || |  |   |||     ||||   ||  | |||    | || |   |       |        ||||| /++++--++-+-+--+---+--++------\| ||  |  | |  | ||   |
||  | |       | ||  |  ||  || |  |   |||     ||||   ||/-+-+++----+-++-+---+-------+--------+++++\|||||  || | |  |   |  ||      || ||  |  | |  | ||   |
||  | |       | ||  | /++--++-+--+---+++-----++++---+++-+-+++----+-++-+-\ |       |   /----+++++++++++--++-+-+--+---+--++------++-++--+--+-+--+-++\  |
||  | |       | ||  | |||  || |  |   |||     ||||   ||| | |||    | || | | |       |/--+----+++++++++++--++-+-+--+-\ |  ||      || ||  |  | |  | |||  |
|\--+-+-------+-++--+-+++>-++-+--+---+++-----++++---+++-+-+++----+-++-+-+-/ /-----++--+----+++++++++++--++-+-+--+-+-+--++------++-++--+--+-+--+\|||  |
|   | |       | ||  | |||  || | /+---+++-----++++---+++\|/+++----+-++-+-+---+-----++--+----+++++++++++--++-+-+--+-+-+--++-\    || ||  |  | |  |||||  |
|  /+-+-------+-++--+\|||  |v | ||   |||     ||||   ||||||\++----+-+/ | |   |     ||  |    |||||||||||  || | |  | | |  || |    || ||  |  | |  |||||  |
|  || |       | ||  |||||  || | ||   |||/----++++---++++++-++----+-+--+-+---+-----++--+----+++++++++++--++-+-+\ | | |  || |    || ||  |  | |  |||||  |
|  || |       | ||  |||||  || | ||   ||||    ||||   |||||| ||    | |  | |   |  /--++--+----+++++++++++--++-+-++-+-+-+--++-+----++-++--+--+-+\ |||||  |
| /++-+-------+-++--+++++--++-+-++---++++----++++---++++++-++----+-+--+-+---+--+--++--+----+++++++++++--++-+\|| | | |  || |    || ||  |  | || |||||  |
|/+++-+-------+-++--+++++--++-+-++---++++----++++---++++++-++\   | |  | |   |  |  ||  |    |||||||||||  || |||| | | |  || |    || ||/-+--+-++-+++++-\|
||||| |       | ||  |||||  || | ||   ||||    ||||   |||||| |||   | |  | |   |  |  ||  |    |||||||||||  || |||| | | |  ||/+----++-+++-+--+\|| ||||| ||
||||| |       | ||  |||||  || | ||   ||||/---++++---++++++-+++\  | |  | |   |  |  ||  |    |||||||||||  || |||| | | |  ||||    || ||| |  |||| ||||| ||
||||| |       | ||  |||||  || | ||   |||||   ||||   |||||| ||||  | |  | | /-+--+-<++--+----+++++++++++--++-++++-+-+-+--++++----++-+++-+--++++-+++++\||
||||| |       | ||  |||||  || | |\---+++++---+/||   |||||| ||||  | |  | |/+-+--+--++--+----+++++++++++--++-++++\| | |  ||||    || ||| |  |||| ||||||||
||||| |     /-+-++--+++++--++-+-+----+++++---+-++-\ |||||| ||||/-+-+--+-+++-+--+--++--+----+++++++++++\ || |||||| | |  ||||    || ||| |  |||| ||||||||
||||| |     | |/++--+++++--++-+-+----+++++---+-++-+-++++++-+++++-+-+--+-+++-+--+--++-\|    |||||||||||| || |||||| | |  ||||    || ||| |  |||| ||||||||
||||| |     | ||||  |||||  || | |    |||||   | || | |||||\-+++++-+-+--+-+++-+--+--++-++----++++++++++++-++-++++++-+-+--+++/    || ||| |  |||| ||||||||
||||| |     | ||||  |||||  || | |    ||||| /-+-++-+-+++++--+++++-+-+--+-+++-+--+--++-++----++++++++++++-++-++++++\| |  |||     || |\+-+--++++-/|||||||
||||| |     | ||||  |||||  || | |    ||||| | | || | ||||| /+++++-+-+--+-+++-+--+--++-++----++++++++++++\|| |||||||| |  |||     || | | |  ||||  |||||||
||||| |     | ||||  ||||| /++-+-+----+++++-+-+-++-+-+++++-++++++-+-+--+-+++-+--+--++-++----+++++++++++++++-++++++++-+\ |||     || | | |  ||||  |||||||
||||| |     | ||||  ||||| ||| | |  /-+++++-+-+-++-+-+++++-++++++-+-+--+-+++-+--+--++\||    |||||||\+++++++-++/||||| || |||  /--++-+-+-+--++++\ |||||||
||||| |     | ||||  \++++-+++-+-+--+-+/||| | | || | ||||| |||||| | |  | ||\-+--+--+++++----+++++++-+++++++-++-+++++-++-+++--+--++-+-+-+--+++++-++++/||
||||| |     | ||||   |||| ||| | |  | | ||| | | || | \++++-++++++-/ |  | ||  |  |  ||||\----+++++++-+++++++-++-+++++-++-+++--+--++-+-+-+--+++++-+++/ ||
||||| |     | ||||   |||| ||| | |  | | ||| | | || |  |||| ||||||   |  | ||  |  |  ||||     ||||||| ||||||| || ||||| || |||  |  || | | |  ||||| |||  ||
||||| |     | ||||   |||| ||| | |  | | ||| | | || |  |||| ||||||   |  | ||  |  |  ||||     ||||||\-+++++++-++-+++++-++-+++--+--/| | | v  ||||| |||  ||
||||| |     | ||||   |||| ||| |/+--+-+-+++-+-+-++-+--++++-++++++---+-\| ||  |  |  ||||     ||||||  ||||||| || ||||| || |||  |   | | | |  ||||| |||  ||
||||| |     | ||||   |||| ||| |||  | | ||| | | || |  \+++-++++++---+-++-++--+--+--++++-----++++++--+++++++-++-+++++-++-+++--+---/ | | |  ||||| |||  ||
||||| |     | ||||   |||| ||| |||  | | ||| | | || |   ||| ||||||   | || ||  |  |  ||||     ||||||  ||||||| || ||||| || |||  |     | | |  ||||| |||  ||
\++++-+-----+-++++---++++-+++-+++--+-+-+++-+-+-/|/+---+++-++++++---+-++-++--+--+\ ||||     ||||||  ||||||| \+-+++++-++-+++--+-----+-+-+--/|||| |||  ||
 |||| |     | |||| /-++++-+++-+++--+-+-+++-+-+--+++---+++-++++++---+-++-++\ |  || ||||     ||||||  |||||||  | ||||| || |||  |     | | |   |||| |||  ||
 |||| |   /-+-++++-+-++++-+++-+++--+-+-+++-+-+--+++---+++-++++++---+-++-+++-+--++-++++-----++++++--+++++++--+-+++++\|| |||  |     | | |   |||| |||  ||
 |||| |   | | |||| | |||| ||| |||  | | ||| | |  |||   ||| ||||||   | ||/+++-+--++-++++-----++++++--+++++++--+-++++++++-+++--+-----+-+-+---++++-+++\ ||
 |||| |   | | |||| | |||| ||| |||  | | ||| | |  |||   ||| ||||||   \-++++++-+--++-++++-----/|||||  |||||||  | |||||||| |||  |     | | |   |||| |||| ||
 \+++-+---+-+-++++-+-++++-+++-+++--+-+-+++-+-+--+++---+++-+++/|\-----++++++-+--++-++++------+++++--+++/|||  | |||||||| |||  |     | | |   |||| |||| ||
  ||| |   | | |||| |/++++-+++-+++-\| | ||| | |  |||   ||| ||| |      |||||| |  || ||||     /+++++--+++-+++--+-++++++++-+++--+-----+-+-+--\|||| |||| ||
  ||| |   | | |||| |||||| ||| ||| || | ||| | |  |||   ||| ||| |      |||||| | /++-++++-----++++++--+++-+++--+-++++++++-+++-\|     | | \--+++++-++++-+/
  ||| |   | | |||| |||||| ||| ||| || | ||| | |  |||   ||| ||| |      |||||| | ||| ||||     ||||||  ||| |||  | |||||||| ||| ||     | |    ||||| |||| | 
  ||| |   | | |||| |||||| |||/+++-++-+-+++-+-+--+++---+++-+++-+------++++++-+-+++-++++-----++++++--+++-+++--+-++++++++-+++\||     | |    ||||| |||| | 
 /+++-+---+-+-++++-++++++-+++++++-++-+-+++-+-+--+++---+++-+++-+------++++++-+-+++\||||     ||||||  ||| |||  | |||||||| ||||||     | \----+++++-++++-/ 
 |||| |   | | |||| |||||| ||||||| || | ||| | |  |||   ||| ||| |      |||||| | ||||||||     ||||||  ||| |\+--+-++++++++-++++++-----/      ||||| ||||   
 |||| |   | | |||| |||||| ||||||| || | ||| | |  |||   ||| ||| |      ||\+++-+-++++++++-----++++++--+++-+-+--+-++++++++-++++++------------+++++-+++/   
 |||\-+---+-+-++++-++++/| ||||||| || | ||| | |  |||   ||| ||| |      || ||| | ||||||||   /-++++++-\||| | |  | |||||||| ||||||            ||||| |||    
 |||  |   | | |||| ||||/+-+++++++-++-+-+++-+-+--+++---+++-+++-+------++-+++-+-++++++++---+-++++++-++++-+-+--+-++++++++-++++++-----\      ||||| |||    
 |||  |   | | |||| |||||| ||||||| || | ||| | |  |||   ||| ||| |      || ||| | ||||||||   | |||||| |||| | |  | |||||||| ||||||     |  /---+++++-+++-\  
 |||  |   | | |||| |\++++-+++++++-/| |/+++-+-+--+++---+++-+++-+------++-+++-+-++++++++---+-++++++-++++-+-+--+-++++++++-++++++-\   |  |   ||||| ||| |  
 |||  |   | | |||| | |||| |||||||  | |||||/+-+--+++---+++-+++-+----\ || |\+-+-++++++++---+-++++++-++++-+-+--+-+/|||||| |||||| |   |  |   ||||| ||| |  
 |||  |   | | |||| | |||| ||||\++--+-+++++++-+--+++---+++-+++-+----+-++-+-+-+-++++++++---+-++++/| |||| | |  | | |||||| |||||| |   |  |   ||||| ||| |  
 |||  |   | | |||| | |||| |||| ||  | ||||||| |  |||   ||| ||| |    | || | | | ||||||||   | |||| | |||| | |  | | |||||| |||||| |   |  |   ||||| ||| |  
 |||  |   | | |||| | |||| |||| ||  | ||||||| |  |||   ||| ||| |    | || | | | ||||||||   | |||| | |||| | |  | | |||||| |||||| |   |  |   ||||| ||| |  
 |||  |   | | |||| | ||||/++++-++--+-+++++++-+--+++---+++-+++-+----+-++-+-+-+-++++++++---+>++++-+-++++-+-+--+-+\|||||| |||||| |   |  |   ||||| ||| |  
 |||  |   | | |||| | ||||||||| ||  | ||||||\-+--+++---+++-+++-+----+-++-+-+-+-++++++++---+-++++-+-++++-+-+--+-+++/|||| |||||| |   |  |   ||||| ||| |  
 |||  |/--+-+-++++-+-+++++++++-++--+-++++++--+--+++---+++-+++-+----+-++-+-+-+-++++++++---+-++++-+-++++-+-+\ | ||| |||| |||||| |   |  |   ||||| ||| |  
 |||  ||  | | |||| | ||||||||| ||  | ||\+++--+--/||   ||| ||| |    | || | | | ||||||||   | |||| | |||| | || | ||| |||| |||||| |   |  |   ||||| ||| |  
 |||  ||  | | |||| | ||||||||| ||  | || |||  |   ||   ||| ||| |    | || | | | ||||||||   | |||| | |||| | || | ||| |||| |||||| |   |  |   ||||| ||| |  
 \++--++--+-+-++++-+-+++++++++-++--+-++-+++--+---++---+++-+++-+----+-++-+-+-+-+++/||||   | |||| | |||| | || | ||| |||| |||||| |   |  |   ||||| ||| |  
  ||  ||  | | |||| | ||||||||| ||  | || |||  | /-++---+++-+++-+----+-++-+-+-+-+++-++++---+-++++-+\|||| | || | ||| |||| |||||| |   |  |   ||||| ||| |  
  ||  ||  |/+-++++-+-+++++++++-++--+-++\|||  | | ||   ||| ||| |    | || | | | ||| ||||   | |||| |||||| |/++-+-+++-++++-++++++\|   |  |   ||||| ||| |  
  ||  ||  |||/++++-+-+++++++++\||  | ||||||  | | ||   ||| ||| |    | || | | | |\+-++++---+-++++-++++++-++++-+-+++-++++-++++++++---+--+---+++/| ||| ^  
  |\--++--++++++++-+-/|||||||||||  | ||||||  | | ||   ||| ||| |    | || | | | \-+-++++---+-++++-++++++-++++-+-+++-++++-++++/|||   |  |   ||| | ||| |  
  |   ||  |||||||| |  |||||||||||  | ||||||  | | ||   ||| |\+-+----+-++-+-+-+---+-++++---+-+/|| |||||| |||| | ||| |||| |||| |||   |  \---+++-+-+++-/  
  |   ||  |||||||| |  |||||||||||/-+-++++++--+-+-++---+++-+-+-+----+-++-+-+-+---+-++++---+-+-++-++++++-++++-+-+++-++++-++++-+++--\|      ||| | |||    
  |   \+--++++++++-+--++++++++++++-+-++++++--+-+-++---+++-+-+-+----+-++-+-+-+---+-++++---+-+-/| |||||| |||| | ||| |||| |||| |||  ||      ||| | |||    
  |    |  |||||\++-+--++++++++++++-+-++++++--+-+-++---+++-+-+-+----+-++-+-+-+---+-+++/   | |  | |||||| |||| | ||| |||| |||| |||  ||      ||| | |||    
  |    \--+++++-++-+--++++++++++++-+-++++++--+-+-++---+++-+-+-+----+-++-+-+-+---+-+++----+-+--+-++++++-+++/ | ||| |||| |||| |||  ||      ||| | |||    
/-+-------+++++\|| |  |||||||||||| | ||||||  \-+-++---+++-+-+-+----+-++-+-+-+---+-+++----+-+--+-++++++-+++--+-+++-++++-++++-+++--++------++/ | |||    
| |       ||||\+++-+--++++++++++++-+-++++++----+-++---+++-+-+-+----+-++-+-+-+---+-+++----+-+--+-++++++-+++--+-+++-++/| |||| |||  ||      ||  | |||    
| |       |||| ||| |  |||||||||||| | ||||||    | ||   ||| | \-+----+-++-+-+-+---+-+++----+-+--+-++++++-+++--+-+++-++-+-++++-+++--++------++--+-++/    
| |       |||| ||| |  |||||||||||| | ||||||    | ||   ||| |   |    | || | | \---+-+++----+-+--+-++++++-+++--+-+++-++-+-++++-+++--++------++--+-/|     
| |       |||| ||| |  ||||||||||\+-+-++++++----+-++---+/|/+---+----+\|| | |     | |||    | |  | |||||| ||\--+-+++-++-+-+/|| |||  ||      ||  |  |     
| |       |||| ||| |  |||||||^|\-+-+-++++++----+-++---+-+++---+----++/| | |     | |||    | |  | |||||| ||  /+-+++-++-+-+-++-+++--++----\ ||  |  |     
| |       |||| ||| |  ||||||\++--+-+-++++++----+-++---+-+++---+----++-/ | |     | |||    | |  | |||||| ||  || ||| || | | || |||  ||    | ||  |  |     
| |       |||| ||| |  |||||| ||  | | ||||||    | ||   | |||   |    ||   | |     | |||    | |  | |||||\-++--++-++/ || | \-++-+++--++----+-++--+--/     
| |       |||| ||| |  ||\+++-++--+-+-++++++----+-++---+-+++---+----++---+-+-----+-/|| /--+-+--+-+++++--++--++-++--++-+---++-+++--++---\| ||  |        
| |       ||\+-+++-+--++-+++-++--+-+-++++++----+-+/   | |||   |    ||   | |     |  || |  | |  | |||||  ||  || ||  || |   || |||  ||   || ||  |        
| |       || | ||| |  || ||| ||  \-+-++++++----+-+----+-+++---+----++---+-+-----+--++-+--+-+--+-+++++--++--++-++--++-+---++-+++--/|   || ||  |        
| |       || | ||| |  || ||| ||    | ||||||    | |    |/+++---+----++---+-+-----+--++-+--+-+--+-+++++--++--++-++--++-+---++-+++---+---++-++--+-----\  
| |       || | ||| |  || ||| ||    | |||\++----+-+----+++++---+----++---+-+-----+--++-+--+-+--+-+++++--++--++-/|  || |   || |||   |   || ||  |     |  
| |       || | |||/+--++-+++-++----+-+++-++----+-+----+++++---+----++---+-+-----+--++-+--+-+--+-+++++--++--++\ |  || |   || |||   |   || ||  |     |  
| |       || | |||||  || \++-++----+-+++-++----+-+----+++++---+----++---+-+-----+--++-+--+-+--+-+++++--++--+++-/  || |   || |||   |   || ||  |     |  
| |       || | ||||\--++--++-++----+-+++-++----+-+----+++++---+----++---+-/     |  || |  | |  | |||||  ||  |||    || |   || |||   |   || ||  |     |  
| |       |\-+-++++---++--++-++----+-++/ ||    | \----+++++---+----++---+-------/  || |  | |  | |||||  ||  |||    || |   || \++---+---++-++--/     |  
|/+-------+--+-++++---++--++-++----+-++--++\   |      |||||   |    ||   |          || |  | \--+-+++++--++--+++----++-+---++--++---+---++-/|        |  
|||       |  | ||||   ||  || ||    | ||  |||   |      ||\++---+----++---+--->------++-+--+----/ |||||  ||  |||    || |   \+--++---+---++--/        |  
|||       |  | |\++---++--++-++----+-++--+++---+------++-++---+----++---+----------++-+--+------++++/  ||  |||    || |    |  ||   |   ||           |  
|||       |  | | ||   ||  || ||/---+-++--+++---+---\  || \+---+----+/   |  /-------++\|  |      ||||   ||  \++----++-+----+--++---+---+/           |  
|||       |  | | \+---++--++-+++---+-++--+++---+---+--++--+---+----+----+--+-------++++--+------+++/   ||   ||    || |    |  ||   |   |            |  
|||/------+--+-+--+---++--++-+++---+-++--+++---+---+--++--+---+--\ |    |  |       |||\--+------+++----++---++----++-+----+--++---+---/            |  
||||      |/-+-+--+---++--++-+++---+-++--+++---+---+--++--+---+--+-+----+--+\      \++---+------+++----++---++----/| |    |  ||   |                |  
||||      || | |  |   ||  || |||   | ||  |||   |   |  ||  |   |  | |    |  ||/------++---+------+++----++---++-----+-+----+--++---+-----\          |  
||||      || | |  |  /++--++-+++---+-++--+++---+---+--++--+---+--+-+----+--+++------++---+------+++<---++---++-----+-+----+--++-\ |     |          |  
||||      ||/+-+--+--+++--++-+++\  | ||  |||   |   |  ||  |   |  | |    |  |||      ||   |      |||/---++---++-----+-+---\|  || | |     |          |  
||||      |||| |  |  |||  \+-++++--+-++--+++---+---+--++--+---+--+-+----+--+++------++---+------++++---++---++-----+-/   ||  || | |     |          |  
||||      |||| |  |  |||   | ||||  | ||  |||   |   |  ||  |   |  | |    |  |||      ||   |      ||||   ||   ||     |     ||  || | |     |          |  
||||      |||| |  |  |||   | ||||  | ||  |||   |   |  ||  |   |  | |    |  \++------+/   |      ||||   ||   ||     |     ||  || | |     |          |  
\+++------++++-/  |  |||   | ||||  | ||  |\+---+---+--++--+---+--+-/    |   ||      |    |      ||||   ||   ||     |     ||  || | |     |          |  
 |||      ||||    |  |\+---+-++++--+-++--+-+---+---+--++--+---+--+------/   ||      |   /+------++++---++---++-----+-----++--++-+-+-----+------\   |  
 |||      ||||    |  | |   | ||||  | |\--+-+---+---+--++--+---+--+----------++------+---++------++++---++---++-----+-----++--+/ | |     |      |   |  
 |\+------++++----+--+-+---+-++++--+-+---+-+---+---+--++--+---+--+----------++------+---++------++++---++---/|     |     ||  |  | |     |      |   |  
 | |      ||||    |  | |   \-++++--+-/   | |   |   |  ||  \---+--+----------++------+---++------++++---/|    |     |     ||  |  | |     |      |   |  
 | |      ||||    |  | |     ||||  |     | |   |   |  ||      |  |          ||      |   ||      ||||    |    |     |     ||  |  | |     |      |   |  
 | |      ||||    |  \-+-----++++--+-----+-+---+---+--++------+--+----------++------+---++------++++----+----+-----+-----++--+--/ |     |      |   |  
 | |      ||||    |    |     ||||  |     | |   \---+--++------+--+----------++->----+---++------+/||    |    |     |     ||  |    |     |      |   |  
 | |      ||||    |    \-----++++--+-----+-+-------+--++------+--+----------++------+---++------+-++----+----+-----+-----++--+----/     |      |   |  
 | |      ||||    \----------++++--+-----+-+-------+--++------+--+----------++------+---++------+-++----+----/     |     ||  |          |      |   |  
 | |      ||||               ||||  |     \-+-------+--++------/  |          |\------+---++------+-++----+----------+-----++--+----------/      |   |  
 | |      ||||               ||\+--+-------+-------/  \+---------+----------+-------+---++->----/ ||    |          |     ||  |                 |   |  
 | |      |||\---------------+/ |  |       |           |         |          |       |   ||        ||    |          |     ||  |                 |   |  
 | |      ||\----------------+--/  \-------+-----------+---------+----------+-------/   ||        ||    |          |     ||  |                 |   |  
 | \------++-----------------+-------------+-----------+---------/          |           ||        ||    |          |     ||  |                 |   |  
 |        ||                 |             |           |                    |           |\--------/\----+----------+-----/|  |                 |   |  
 |        \+-----------------+-------------+-----------+--------------------+-----------+---------------+----------/      |  |                 |   |  
 \-<-------+-----------------+-------------/           |                    |           \---------------+-----------------+--+-----------------/   |  
           \-----------------+-------------------------+--------------------/                           |                 |  |                     |  
                             \-------------------------+------------------------------------------------+-----------------/  |                     |  
                                                       |                                                \--------------------/                     |  
                                                       \-------------------------------------------------------------------------------------------/  '''

def solve(m, carts):
  carts = carts.copy()
  first_crash = None
  
  while len(carts) > 1:
    for (row, col), (dr, dc, intersections) in sorted(carts.items()):
      if (row, col) not in carts:
        continue
      
      if m[(row, col)] == '\\':
        dr, dc = dc, dr
      elif m[(row, col)] == '/':
        dr, dc = -dc, -dr
      elif m[(row, col)] == '+':
        if intersections % 3 == 0:
          dr, dc = -dc, dr
        elif intersections % 3 == 2:
          dr, dc = dc, -dr
        intersections += 1
      
      del carts[(row, col)]
      row += dr
      col += dc
      
      if (row, col) in carts:
        del carts[(row, col)]
        first_crash = first_crash or f'{col},{row}'
      else:
        carts[(row, col)] = (dr, dc, intersections)

  last_row, last_col = list(carts)[0]
  return first_crash, f'{last_col},{last_row}'
  

m = {(row, col): value for row, line in enumerate(inp.splitlines()) for col, value in enumerate(line)}
carts = {(row, col): ((value == 'v') - (value == '^'), (value == '>') - (value == '<'), 0) for (row, col), value in m.items() if value in '^>v<'}

first_crash, last_cart = solve(m, carts)

answer = first_crash
print(answer)

answer = last_cart
print(answer)
